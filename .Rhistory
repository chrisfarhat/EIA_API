?read
?scan
# script to access the EIA's beta API, convert data, then plot
# requires a unique API key which can be obtained at: http://www.eia.gov/beta/api/
#series
series = "ELEC.PRICE."
#Two letter state abbreviation
state = "TX"
#Type All = All, Residential =
type = "ALL"
#Time A = Annual, M = Monthly, Q = Quarterly
time = "A"
#API Key
key <- scan(/Users/jim/Documents/R/private_EIA_API_key.txt)
key <- scan("/Users/jim/Documents/R/private_EIA_API_key.txt")
key <- scan("/Users/jim/Documents/R/private_EIA_API_key.txt", what = character)
key <- scan("/Users/jim/Documents/R/private_EIA_API_key.txt", what = "character")
require(RCurl)
require(RJSONIO)
install.packages("RJSONIO")
# script to access the EIA's beta API, convert data, then plot
# requires a unique API key which can be obtained at: http://www.eia.gov/beta/api/
#series
series = "ELEC.PRICE."
#Two letter state abbreviation
state = "TX"
#Type All = All, Residential =
type = "ALL"
#Time A = Annual, M = Monthly, Q = Quarterly
time = "A"
#API Key
key <- scan("/Users/jim/Documents/R/private_EIA_API_key.txt", what = "character")
require(RCurl)
require(RJSONIO)
#Create API url
#Create API url
id<-paste(series,state,"-",type,".",time, sep="")
api<-paste("http://api.eia.gov/series/data?api_key=",key,"&series_id=",id, sep="")
#Get data via RCurl
data_json<-getURL(api, followlocation = TRUE)
#Convert JSON format to R format, then flatten structure
data_nested<-fromJSON(data_json, nullValue="NA")[[2]]
data<- data.frame(
year = as.numeric(rapply(data_nested, function(x) x[1], how= "unlist")),
price = as.numeric(rapply(data_nested, function(x) x[2], how= "unlist")))
data<-data[-1,]
plot(data, main = id, type = "b")
}
plot(data)
str(data)
str(data_json)
data_json
data<- data.frame(
year = as.numeric(rapply(data_nested, function(x) x[1], how= "unlist")),
price = as.numeric(rapply(data_nested, function(x) x[2], how= "unlist")))
data
data_nested
data
data_nested
t1<-rapply(data_nested, function(X) x[1], how = "unlist")
?unlist
unlist(data_nested)
str(data_nested)
plot(data_nested)
ul<-unlist(data_nested)
str(ul)
?rbind
# script to access the EIA's beta API, convert data, then plot
# requires a unique API key which can be obtained at: http://www.eia.gov/beta/api/
#series
series = "ELEC.PRICE."
#Two letter state abbreviation
state = "TX"
#Type All = All, Residential =
type = "ALL"
#Time A = Annual, M = Monthly, Q = Quarterly
time = "A"
#API Key
key <- scan("/Users/jim/Documents/R/private_EIA_API_key.txt", what = "character")
require(RCurl)
require(RJSONIO)
#Create API url
id<-paste(series,state,"-",type,".",time, sep="")
api<-paste("http://api.eia.gov/series/data?api_key=",key,"&series_id=",id, sep="")
#Get data via RCurl
data_json<-getURL(api, followlocation = TRUE)
#Convert JSON format to R format, then flatten structure
data_nested<-fromJSON(data_json, nullValue="NA")[[2]]
data<-unlist(data_nested)
data
data[1]
data[0]
data[2]
len(data_nested)
length(data_nested)
length(data_nested)
length(data)
data_nested<-fromJSON(data_json, nullValue="NA")[[2]]
len<-(length(unlist(data_nested))-2)
df <- data.frame(matrix(unlist(data_nested), nrow=len, byrow=2))
data
len
data_nested
data
str(data)
data_nested<-fromJSON(data_json, nullValue="NA")[[2]]
len<-(length(unlist(data_nested))-1)
df <- data.frame(matrix(unlist(data_nested), nrow=len, byrow=2))
df <- data.frame(matrix(unlist(data_nested[-1]), nrow=len, byrow=2))
data_nested[-1]
#Convert JSON format to R format, then flatten structure
data_nested<-fromJSON(data_json, nullValue="NA")[[2]]
ul_data<-unlist(data_nested)
len<-length(ul_data-1)
type(ul_data)
str(ul_data)
?unlist
ul_data[-1:]
ul_data[-1]
df <- data.frame(matrix(ul_data[1], nrow=len, byrow=2))
df
str(df)
df <- data.frame(matrix(ul_data, nrow=len, byrow=2))
ul_data<-unlist(data_nested[-1])
len<-length(ul_data-1)
df <- data.frame(matrix(ul_data, nrow=len, byrow=2))
require(plyr)
install.packages("plyr")
require(plyr)
df <- ldply (data_nested, data.frame)
str(df)
df
str(df)
?plyr
?ldply
#series
series = "ELEC.PRICE."
#Two letter state abbreviation
state = "TX"
#Type All = All, Residential =
type = "ALL"
#Time A = Annual, M = Monthly, Q = Quarterly
time = "A"
#API Key
key <- scan("/Users/jim/Documents/R/private_EIA_API_key.txt", what = "character")
require(RCurl)
require(RJSONIO)
require(plyr)
#Create API url
id<-paste(series,state,"-",type,".",time, sep="")
api<-paste("http://api.eia.gov/series/data?api_key=",key,"&series_id=",id, sep="")
#Get data via RCurl
data_json<-getURL(api, followlocation = TRUE)
#Convert JSON format to R format, then flatten structure
data_nested
install.packages("jsonlite")
flatten(data_json)
require(jsonlite)
flatten(data_json)
flatten(data_nested)
data_json<-getURL(api, followlocation = TRUE)
#Convert JSON format to R format, then flatten structure
data_nested<-fromJSON(data_json, nullValue="NA")[[2]]
#Convert JSON format to R format, then flatten structure
data <- fromJSON(data_json, flatten = true)
data
# script to access the EIA's beta API, convert data, then plot
# requires a unique API key which can be obtained at: http://www.eia.gov/beta/api/
require(RCurl)
require(plyr)
require(jsonlite)
#series
series = "ELEC.PRICE."
#Two letter state abbreviation
state = "TX"
#Type All = All, Residential =
type = "ALL"
#Time A = Annual, M = Monthly, Q = Quarterly
time = "A"
#API Key
key <- scan("/Users/jim/Documents/R/private_EIA_API_key.txt", what = "character")
#Create API url
id<-paste(series,state,"-",type,".",time, sep="")
api<-paste("http://api.eia.gov/series/data?api_key=",key,"&series_id=",id, sep="")
#Get data via RCurl
data_json<-getURL(api, followlocation = TRUE)
#Convert JSON format to R format, then flatten structure
data <- fromJSON(data_json, flatten = true)
data
